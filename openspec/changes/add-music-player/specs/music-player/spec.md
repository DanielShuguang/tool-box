## 新增需求

### 需求：左右布局设计

系统必须采用左右布局设计，左侧为播放器控制区，右侧为播放列表。

#### 场景：左侧播放器控制区

- **当** 用户打开音乐播放器页面
- **那么** 系统必须在左侧显示播放器控制区
- **并且** 左侧必须包含当前播放歌曲信息（封面、标题、艺术家）
- **并且** 左侧必须包含播放控制按钮（播放/暂停、上一首、下一首）
- **并且** 左侧必须包含进度条和音量控制
- **并且** 左侧必须保证在一屏内显示，不出现滚动条

#### 场景：右侧播放列表区

- **当** 用户打开音乐播放器页面
- **那么** 系统必须在右侧显示播放列表
- **并且** 右侧必须显示所有导入的音频文件
- **并且** 右侧必须支持滚动查看所有歌曲
- **并且** 右侧必须提供删除歌曲的操作

#### 场景：响应式布局切换

- **当** 用户在小屏幕设备上使用播放器（宽度小于 768px）
- **那么** 系统必须自动切换为垂直布局
- **并且** 播放器控制区必须位于上方
- **并且** 播放列表必须位于下方

### 需求：长歌名自动滚动动画

系统必须为长歌名提供自动滚动动画效果，确保用户能看到完整的歌曲信息。

#### 场景：触发滚动动画

- **当** 当前播放歌曲的标题超过 15 个字符
- **那么** 系统必须启用自动滚动动画效果
- **并且** 动画速度必须较慢（约 20 秒完成一次滚动）

#### 场景：不触发滚动动画

- **当** 当前播放歌曲的标题不超过 15 个字符
- **那么** 系统必须显示完整的歌曲标题
- **并且** 系统必须不启用滚动动画效果

#### 场景：使用 motion-v 实现动画

- **当** 系统实现滚动动画效果
- **那么** 系统必须使用 motion-v 库实现
- **并且** 动画必须包裹在 AnimatePresence 组件中
- **并且** 动画必须使用 motion 组件而非 Motion 组件

### 需求：业务逻辑拆分架构

系统必须采用模块化的业务逻辑架构，将功能拆分为多个独立的 hooks。

#### 场景：音频核心逻辑

- **当** 系统管理音频播放核心功能
- **那么** 系统必须使用 useAudioCore hook
- **并且** 该 hook 必须负责音频播放、暂停、进度控制等核心功能

#### 场景：播放列表管理

- **当** 系统管理播放列表
- **那么** 系统必须使用 usePlaylist hook
- **并且** 该 hook 必须负责添加、删除、清空播放列表等操作

#### 场景：播放模式控制

- **当** 系统管理播放模式
- **那么** 系统必须使用 usePlayMode hook
- **并且** 该 hook 必须负责顺序、循环、随机三种模式的切换

#### 场景：音量控制

- **当** 系统管理音量
- **那么** 系统必须使用 useVolume hook
- **并且** 该 hook 必须负责音量调整和静音功能

#### 场景：文件加载

- **当** 系统加载音频文件
- **那么** 系统必须使用 useFileLoader hook
- **并且** 该 hook 必须负责文件夹选择和文件导入功能

#### 场景：拖拽上传

- **当** 系统处理拖拽上传
- **那么** 系统必须使用 useAudioDrop hook
- **并且** 该 hook 必须负责拖拽事件处理和文件验证

#### 场景：组合 hooks

- **当** 组件需要使用多个 hooks
- **那么** 系统必须通过 useAudioPlayer 组合 hook 统一导出所有功能
- **并且** 组件只需导入 useAudioPlayer 即可使用所有功能

### 需求：后端通信封装

系统必须将后端调用封装到 backend-channel 模块中，不直接在组件中使用 invoke。

#### 场景：封装音频文件操作

- **当** 系统需要调用后端获取音频文件
- **那么** 系统必须使用 src/backend-channel/music-player.ts 中的函数
- **并且** 组件不得直接使用 invoke 调用后端

#### 场景：类型定义

- **当** 定义后端通信的数据类型
- **那么** 系统必须在 src/backend-channel/models/music-player.ts 中定义
- **并且** 类型定义必须与 Rust 后端的结构体对应

### 需求：音频文件导入

系统必须支持用户通过文件夹选择或拖拽方式导入本地音频文件。

#### 场景：通过文件夹选择导入

- **当** 用户点击选择文件夹按钮并选择包含音频文件的目录
- **那么** 系统必须扫描该目录及其子目录中的所有支持的音频文件
- **并且** 系统必须将这些文件添加到播放列表中

#### 场景：拖拽导入音频文件

- **当** 用户将一个或多个音频文件拖拽到播放器区域
- **那么** 系统必须识别这些文件为有效的音频格式
- **并且** 系统必须将这些文件添加到播放列表中

#### 场景：处理无权限文件或目录

- **当** 系统在扫描音频文件时遇到没有读取权限的文件或目录
- **那么** 系统必须跳过该文件或目录
- **并且** 系统必须继续扫描其他文件和目录
- **并且** 系统必须不因为权限问题而中断整个导入任务

### 需求：播放控制

系统必须提供完整的音频播放控制功能。

#### 场景：播放和暂停

- **当** 用户点击播放按钮且当前有选中的音频文件
- **那么** 系统必须开始播放该音频文件
- **并且** 播放按钮状态必须切换为暂停图标

#### 场景：切换上一首/下一首

- **当** 用户点击上一首或下一首按钮
- **那么** 系统必须停止当前播放的音频
- **并且** 系统必须开始播放播放列表中的上一首或下一首音频

#### 场景：调整播放进度

- **当** 用户拖动进度条到指定位置
- **那么** 系统必须将当前音频播放位置调整到该时间点

#### 场景：调整音量

- **当** 用户调整音量滑块
- **那么** 系统必须实时调整音频播放音量

### 需求：播放列表管理

系统必须允许用户管理播放列表中的音频文件。

#### 场景：删除播放列表中的歌曲

- **当** 用户点击删除按钮移除播放列表中的某首歌曲
- **那么** 该歌曲必须从播放列表中移除
- **并且** 如果该歌曲正在播放，系统必须停止播放

#### 场景：清空播放列表

- **当** 用户点击清空播放列表按钮
- **那么** 所有歌曲必须从播放列表中移除
- **并且** 系统必须停止当前播放

### 需求：播放模式

系统必须支持不同的播放模式。

#### 场景：顺序播放模式

- **当** 用户选择顺序播放模式
- **那么** 当前歌曲播放完成后，系统必须自动播放下一首歌曲
- **并且** 播放到最后一首后系统必须停止

#### 场景：循环播放模式

- **当** 用户选择循环播放模式
- **那么** 当前歌曲播放完成后，系统必须自动播放下一首歌曲
- **并且** 播放到最后一首后系统必须回到第一首继续播放

#### 场景：随机播放模式

- **当** 用户选择随机播放模式
- **那么** 当前歌曲播放完成后，系统必须随机选择下一首歌曲播放

### 需求：音频元数据显示

系统必须显示当前播放音频的元数据信息。

#### 场景：显示歌曲信息

- **当** 音频文件开始播放
- **那么** 系统必须显示歌曲标题、艺术家、专辑名称和总时长

#### 场景：显示播放进度

- **当** 音频正在播放
- **那么** 系统必须实时更新当前播放时间和进度条位置

### 需求：状态持久化

系统必须持久化播放列表和播放状态。

#### 场景：保存播放列表

- **当** 用户关闭应用
- **那么** 系统必须保存当前播放列表到本地存储

#### 场景：恢复播放状态

- **当** 用户重新打开应用
- **那么** 系统必须恢复上次保存的播放列表
- **并且** 系统必须恢复播放模式设置
