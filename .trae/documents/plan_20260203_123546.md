# 画板应用开发计划

## 技术选型
选择 **Fabric.js** 作为 canvas 库，原因：
- 功能全面，原生支持对象选择、移动、缩放、旋转
- 丰富的图形类型和属性编辑
- 支持 PNG、JPG、SVG 导出
- 良好的社区支持和文档

## 项目结构
```
src/
├── views/
│   └── CanvasBoard/                    # 画板视图
│       ├── CanvasBoard.vue            # 画板主组件
│       ├── components/
│       │   ├── Toolbar.vue             # 工具栏组件
│       │   ├── PropertyPanel.vue       # 属性编辑面板
│       │   ├── ExportDialog.vue       # 导出对话框
│       │   └── HistoryPanel.vue       # 历史记录面板
│       ├── logic.ts                    # 画板主逻辑
│       ├── types.ts                    # 类型定义
│       └── hooks/
│           ├── useCanvas.ts            # 画布基础操作
│           ├── useDrawingTools.ts      # 绘图工具
│           ├── useObjectOperation.ts   # 对象操作
│           ├── useHistory.ts           # 历史记录管理
│           ├── useKeyboardShortcuts.ts # 键盘快捷键
│           └── useAutoSave.ts          # 自动保存
├── stores/
│   └── canvasStore.ts                  # 画板状态管理
├── backend-channel/
│   └── canvas.ts                       # 后端命令（文件操作）
└── types/
    └── canvas.ts                       # 画板相关类型
```

## 功能模块实现

### 1. 基础框架搭建
- 添加 Fabric.js 依赖
- 创建 CanvasBoard 页面和路由配置
- 实现基础画布初始化和响应式布局

### 2. 工具栏实现
- 图形工具：选择、矩形、圆形、椭圆、直线、曲线、多边形、自由绘制
- 颜色选择器：前景色、背景色
- 线条设置：线宽、透明度
- 操作按钮：撤销、重做、导出、导入

### 3. 图形绘制功能
- 实现各种图形工具的绘制逻辑
- 实现鼠标事件处理（mousedown、mousemove、mouseup）
- 实现绘制过程中的实时预览

### 4. 图形属性编辑
- 颜色编辑（填充色、描边色）
- 线条属性（线宽、描边样式）
- 透明度调整
- 旋转和缩放控制

### 5. 图形操作
- 对象选择和选中状态管理
- 移动、缩放、旋转实现
- 删除和复制功能

### 6. 历史记录管理
- 实现 20 步以上的 Undo/Redo
- 使用状态快照或命令模式
- 实时保存到本地存储

### 7. 文件操作
- 导入：PNG、JPG、SVG
- 导出：PNG、JPG、SVG
- 使用 Tauri API 实现文件对话框

### 8. 快捷键支持
- Ctrl+Z：撤销
- Ctrl+Y：恢复
- Delete：删除选中对象
- 滚轮缩放画布
- 空格+拖拽：平移画布

### 9. 自动保存
- 定时保存画布状态
- 页面刷新后自动恢复
- 异常关闭后的状态恢复

### 10. 性能优化
- 使用 requestAnimationFrame 优化渲染
- 对象操作防抖处理
- 历史记录内存管理

### 11. 单元测试
- 基础画布操作测试
- 绘图工具测试
- 历史记录测试
- 文件操作测试

## 开发顺序
1. 依赖安装和基础配置
2. 页面创建和路由配置
3. 画布基础功能
4. 工具栏和属性面板
5. 图形绘制和操作
6. 历史记录管理
7. 文件导入导出
8. 快捷键支持
9. 自动保存功能
10. 单元测试
11. 代码优化和测试

## 预计文件数量
- 视图文件：1 个主页面 + 4 个组件
- 逻辑文件：1 个主逻辑 + 6 个 hooks
- 状态管理：1 个 store
- 类型定义：1 个类型文件
- 后端命令：1 个文件
- 测试文件：4-6 个测试文件

总计约 15-20 个新文件