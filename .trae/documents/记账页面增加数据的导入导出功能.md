# 记账页面增加数据的导入导出功能实现计划

## 功能需求
- 导出功能：支持将记账数据导出为 JSON 和 XLSX 格式
- 导入功能：支持从 JSON 和 XLSX 文件导入记账数据
- 特殊字符处理：确保备注等字段中的特殊字符在导入导出过程中正确处理

## 实现方案

### 1. 修改记账页面组件
- 在 `Accounting.vue` 中添加导入导出按钮
- 按钮位置：收支记录表格的头部区域
- 添加导出格式选择对话框

### 2. 扩展记账逻辑
- 在 `logic.ts` 中添加以下函数：
  - `exportData(format: 'json' | 'xlsx')`: 导出所有记账数据为指定格式文件
  - `importData()`: 从文件导入记账数据（自动识别格式）
  - `convertToXLSX(records: AccountingRecord[])`: 将记账记录转换为 XLSX 格式
  - `parseXLSX(content: ArrayBuffer)`: 解析 XLSX 格式的记账记录

### 3. 利用现有工具
- 复用 `file-io.ts` 中的文件操作功能：
  - `saveFile()`: 保存导出的文件
  - `selectImportFile()`: 选择导入的文件
  - `readFileContent()`: 读取文件内容（用于 JSON）
- 新增函数用于读取二进制文件（用于 XLSX）

### 4. 数据结构设计
- JSON 导出数据结构：
  ```typescript
  {
    records: AccountingRecord[], // 记账记录
    categories: Category[]       // 分类信息
  }
  ```
- XLSX 导出格式：
  - 工作表1：记账记录（包含所有字段）
  - 工作表2：分类信息

### 5. 实现步骤
1. **修改 Accounting.vue**：添加导入导出按钮和相关事件处理
2. **扩展 logic.ts**：实现导入导出逻辑函数，使用 xlsx 库处理 Excel 文件
3. **添加二进制文件读取功能**：在 `file-io.ts` 中添加读取二进制文件的函数，用于处理 XLSX 文件
4. **数据验证**：导入时验证数据格式的正确性
5. **用户反馈**：添加操作成功/失败的提示信息
6. **测试**：确保导入导出功能正常工作，特别是包含特殊字符的情况

### 6. 技术要点
- 使用 Tauri 的文件系统 API 进行文件操作
- 使用 xlsx 库处理 Excel 文件的读写
- 确保 JSON 数据的正确序列化和反序列化
- 导入时处理可能的重复数据
- 提供清晰的用户操作反馈

## 预期效果
- 用户可以通过点击导出按钮选择格式（JSON 或 XLSX）并将所有记账数据保存为文件
- 用户可以通过点击导入按钮选择文件并将数据导入到系统中
- 包含特殊字符的备注字段在导入导出过程中保持完整
- 导入导出操作有明确的成功/失败提示
- 导入的数据与现有数据无缝集成